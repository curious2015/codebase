Допустим у нас есть стейкхолдеры и им нужно собрать определенную сумму инвестиций в конкретной выбранной валюте. Для примера им нужно будет собрать 6000 ETH. Процесс сбора средств заключается в обмене токенов, имеющихся у стейкхолдеров (для примера назовем их UTT), в эквиваленте на ETH. Делать это лучше всего через биржу, организовав торги со стартовой ценой, дабы собрать по возможности как можно большую сумму и подогреть ценность токена.

Процесс распределения токена:
1) Для начала определимся со стартовым курсом токена. Для нашего примера, допустим, что по нашей экономике 1 UTT будет оценен в 10 ETH. Соответственно нам нужно обменять 600 UTT не менее чем на 6000 ETH. Стартовый курс задается экономикой сбора средств.
2) Сумму мы собираем окнами, для этого произвольно определяется число окон, даты их закрытия и объемы распределяемого токена для каждого окна. Допусим в нашем примере имеется 3 окна на 100 UTT, 200 UTT, 300 UTT. Закрываются они в моменты времени t1, t2 и t3 соответственно. Реальные объемы окон и даты их закрытия определяются экономикой сбора средств, но начинать лучше с меньших объемов, дабы большие объемы уходили за большие средства на фоне разогретого интереса и спекуляции.
3) Рассмотрим для примера первое окно (все последующие окна идентичны и отличаются датой закрытия и объемом распределяемого токена). Нужно распределить 100 UTT в обмен на как минимум 1000 ETH на момент закрытия окна t1. Стейкхолдеры вносят на специальную учетку UTT до необходимой суммы в 100 UTT. Допустим у нас 3 стейкхолдера: s1 внес 50 UTT, s2 внес 20 UTT, s3 внес 30 UTT. По закрытию окна они должны будут получить 50%, 20% и 30% от собранной суммы соответственно.
3) Для того, чтобы инвесторы могли учавствовать в аукционе, им нужно взять свой ETH и зайти на биржу, где проводится аукцион по распределению UTT. В связи с тем, что UTT и ETH находятся в разных блокчейнах, на бирже нужно воспользоваться готовым эквивалентом существующего шлюза в Ethereum или же разработать свой шлюз. Допустим у нас есть шлюз, токеном которого является uETH и мы закрепили его использование в рамках распределения UTT. Инвесторы обменивают свой ETH на uETH в шлюзе, теперь они участники биржи и у них есть токен, с которым можно учавствовать в аукционе.
4) Инвесторы на бирже начинают публиковать ордера на покупку UTT за uETH. В связи с тем, что это аукцион, то инвесторам придется бороться за право купить UTT, делая ордера с большей стоимостью UTT в uETH, перебивая стоимость конкурентов. Таким образом на бирже сформируется пул предложений на покупку разных объемов UTT за uETH по различным курсам. Ордера с большей стоимостью UTT будут иметь больший шанс на успех во время закрытия окна.
5) На момент закрытия окна запускается аукционный бот. Допустим что у нас есть такой бот. Бот знает сколько UTT находится на специальной учетке и какие стейкхолдеры и в каких объемах сформировали этот баланс. Соответственно бот может выкупить uETH за UTT по самым выгодным предложениям, а затем раздать uETH стейхолдерам, которые сформировали раздаваемый объем стейка в эквивалетных долях. Добробный алгоритм работы бота и требования к нему описаны ниже.
6) Стейкхолдеры могут вывести свои uETH с биржи в ETH через тот же самый шлюз. Инвесторы, которые не смогли приобрести UTT, смогут так же вывести свой uETH обратно в ETH через шлюз. Так же теперь они смогут приобрести UTT у спекулянтов (тех, кто смог купить UTT за предыдущие окна).

Плюсы данного подхода:
1) Не нужно реализовать умные контракты в Ethereum
2) Можно использовать готовые шлюзы, но так же можно поднять состояние на своем шлюзе
3) В бирже останется история операций и курс токена, распределение даст хороший старт токену на бирже
4) Сам процесс сбора средств будет проходить через один блокчейн, Ethereum будешь лишь точкой входа/выхода
5) Схема очень проста и прозрачна для разработчиков и стейкхолдеров
6) !!!Не нужен возврат средств инвесторам в случае неудачных торгов (сразу можно проанализировать, что мы не соберем необходимые средства по закрытию окна и не совершать никаких операций)!!!

Минусы данного подхода:
1) Сложная схема для инвесторов, требующая входить через шлюз и делать ставки на бирже, а значит, придется реализовать удобный и простой GUI для инвесторов, покрывающий все шаги процесса сбора средств
2) Есть нерешенные вопросы (смотрите пункт "открытые вопросы и проблемы")
3) Придется реализовать бота

Требования к боту:
1) Бот должен быть написан на python
2) Бот должен иметь максимально простой и надежный исходный код
2) Бот должен иметь доступ к бирже и служебному кошельку
3) Бот должен знать объем окна и не должен продавать больший объем UTT, даже если баланс служебного кошелька его превышает (случайно было внесено большее количество UTT)
4) Бот должен продавать UTT только за uETH не ниже стартовой цены и только по максимально выгодным предложениям покупки
5) Бот не должен совершать никаких операций, если рынок не позволяет ему продать весь объем окна, соблюдая пункт 4 (предложения на покупку UTT не ниже стартовой цены не покрывают весь объем окна в UTT)

Алгоритм работы бота:
1) Бот ждет момента закрытия окна и не приступает к пункту 2 раньше этого момента времени
2) Бот должен проверить, что на балансе служебной учетки хватает UTT для покрытия объема окна, иначе торги не состоятся
3) Бот должен проверить, что на бирже хватает предложений на покупку UTT по цене не ниже стартовой для покрытия объема окна, иначе торги не состоятся
4) Бот должен идти в цикле, пока не распродаст нужный объем UTT и повторять следующие действия:
	4.1) Берется ордер на покупку UTT за uETH с максимальной ценой UTT
	4.2) Проверяется, что цена не ниже стартовой, если ниже, то бот выходит из цикла, иначе идет дальше
	4.3) Бот продает UTT по данному ордеру в таком объеме, чтобы не превысить общий объем окна min(orderVol, windowVol-soldVol)
5) Выполняется проверка, что был распродан весь необходимый объем UTT в рамках окна (soldVol >= windowVol), если нет, то получается исключительная ситуация
6) Бот высчитывает по истории операций процент участия каждого стейкхолдера (currUTT/totalUTT) и переводит стейкхолдерам долю собранных uETH в эквивалентном проценте
7) Бот возвращает стейкхолдерам лишний внесенный ими UTT

Рассчет доли участия стейкхолдера, его вознаграждения и объема возвращаемого стейка:
1) От каждого стейкхолдера берутся операции, сформировавшие общий баланс на момень закрытия окна currUTT
2) Далее они складываются в общую сумму totalUTT
3) Доля участия считается путем деления currUTT на totalUTT: stakePart=currUTT/totalUTT
4) Вознаграждение стейкхолдера считается путем умножения доли его участия на объем собранных uETH: stakePart * totalETH
5) Учтенный стейк считается путем умножения доли участия стейкхолдера на объем окна: creditedUTT = stakePart * windowUTT
6) Стейк, подлежащий возврату считается путем вычитания учтенного стейка из внесенного стейка: currUTT - creditedUTT

Подбираемые параметры процесса и экономики:
1) Объем собираемой суммы и в какой валюте идет сбор средств
2) Стоимость токена и, соответственно, объем токена, выпущенного в на торги
3) Количество окон, даты их закрытия и объемы распределения в токенах
4) Выбор биржи: наша или DEX; рекомендуется DEX как биржа, где уже есть жизнь и люди будучие не в теме, которые могут заинтересоваться UTT, зашлюзоваться в нашу всегда успеем
5) Выбор/разработка подходящего шлюза и закрепление шлюзового токена как единственного, учавствующего в распределении

Открытые вопросы и проблемы:
1) Кто будет платить комиссию за бота, за инвесторов? Откуда инвесторам брать core asset биржи на комсу, если он придет только с шлюзовым токеном?
2) Что имеется в виду под открытием окна? Какую информацию публиковать заранее, а какую в момент открытия окна? Может у нас будет только закрытие окон, а драка за самый сочный курс UTT пусть всегда идет параллелньно спекуляции на рынке теми, кто уже урвал себе UTT?
3) Стоит подумать как отразятся действия спекулянтов на проуесс распределения во 2м 3м и так далее окнах, бот не отличит ордер на покупку сделанный в рамках распределения, от обычного. Спекулянты могут создавать конкуренцию боту, выкупая uETH за их UTT по хорошей цене до закрытия окна, для инвесторов это даже выгодно, а для бота и стейкхолдеров следует подумать, пока я не вижу большой проблемы в общем рынке торгов и распределения
4) Не понятно как будут конкурировать стейкхолдеры между собой и как защититься от того, что кто-то один первым внесет весь объем окна на служебную учетку. Один из вариантов описан в "Рассчет доли участия стейкхолдера"
5) Пункт 5 алгоритма, возможен если между пунктом 3 и 4 кто-то другой урвал часть ордеров, или ордера на покупку были отменены. Сложность в том, что вернуть eUTH еще можно, но забрать обратно UTT уже нельзя в целях отката торгов

[Схема](https://www.draw.io/#Hu-transnet%2Fcodebase%2Fexchange_bot%2FRaising%20funds%20by%20exchange%20bot%2FRaising%20funds%20by%20exchange%20bot.xml)
